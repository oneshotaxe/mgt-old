(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{565:function(e,t,n){(function(n){var r,o,l;o=[],void 0===(l="function"==typeof(r=function(){"use strict";function t(b,e,t){var n=new XMLHttpRequest;n.open("GET",b),n.responseType="blob",n.onload=function(){a(n.response,e,t)},n.onerror=function(){console.error("could not download file")},n.send()}function r(a){var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function o(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(e){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,a=l.saveAs||("object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype?function(b,g,e){var i=l.URL||l.webkitURL,n=document.createElement("a");g=g||b.name||"download",n.download=g,n.rel="noopener","string"==typeof b?(n.href=b,n.origin===location.origin?o(n):r(n.href)?t(b,g,e):o(n,n.target="_blank")):(n.href=i.createObjectURL(b),setTimeout((function(){i.revokeObjectURL(n.href)}),4e4),setTimeout((function(){o(n)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,g,n){if(g=g||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(a,b){return void 0===b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\ufeff",a],{type:a.type}):a}(e,n),g);else if(r(e))t(e,g,n);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){o(i)}))}}:function(a,b,e,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof a)return t(a,b,e);var g="application/octet-stream"===a.type,r=/constructor/i.test(l.HTMLElement)||l.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||g&&r)&&"object"==typeof FileReader){var o=new FileReader;o.onloadend=function(){var a=o.result;a=i?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=a:location=a,n=null},o.readAsDataURL(a)}else{var c=l.URL||l.webkitURL,d=c.createObjectURL(a);n?n.location=d:location.href=d,n=null,setTimeout((function(){c.revokeObjectURL(d)}),4e4)}});l.saveAs=a.saveAs=a,e.exports=a})?r.apply(t,o):r)||(e.exports=l)}).call(this,n(81))},566:function(e,t,n){"use strict";var r=n(2),o=n.n(r),l={props:["value"],data:function(){return{menu:!1}},computed:{formattedDate:function(){return this.value?o()(this.value).format("DD/MM/YYYY"):""}},methods:{changeDate:function(e){this.$emit("input",e),this.menu=!1},nextDay:function(){this.$emit("input",o()(this.value).add(1,"d").format("YYYY-MM-DD"))},prevDay:function(){this.$emit("input",o()(this.value).subtract(1,"d").format("YYYY-MM-DD"))}}},c=n(23),d=n(26),f=n.n(d),h=n(557),v=n(175),m=n(77),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-menu",{attrs:{"close-on-content-click":!1,"max-width":"290"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[n("v-text-field",e._g({staticClass:"desable-shadow mr-4",staticStyle:{"box-shadow":"none"},attrs:{flat:"",solo:"","hide-details":"",value:e.formattedDate,label:"Date",readonly:""}},r))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e._v(" "),n("v-date-picker",{attrs:{value:e.value,"no-title":""},on:{change:e.changeDate}})],1)}),[],!1,null,null,null);t.a=component.exports;f()(component,{VDatePicker:h.a,VMenu:v.a,VTextField:m.a})},578:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n(24),n(27);var r=n(20),o=n(180),l=function e(t,n){var l=this;Object(r.a)(this,e),this.errors=[],this.workTable=[],this.driverReserveCount=0,this.driverReserveTable=[],this.busReserve=[],this.outDrivers={"Выходной":[],"Больничный":[],"Отпуск":[]},this.outBuses={"Ремонт":[],"СВАРЗ":[]},n.forEach((function(e){var n={"Рабочий":[],"Первая см.":[],"Вторая см.":[]},r=0;e.drivers.forEach((function(e){var c=(e=new o.a(e)).statusesByDate({date:t,count:1,isShort:!1,withExceptions:!0})[0].status;c?["Рабочий","Первая см.","Вторая см."].includes(c)?(r++,n[c].push(e)):l.outDrivers[c].push(e):l.errors.push("У водителя ".concat(e.tabnumber," нет статуса"))})),["Ремонт","СВАРЗ","Долгостой"].includes(e.status)?("Долгостой"==e.status?l.outBuses["Ремонт"].push(e):l.outBuses[e.status].push(e),0!==r&&(l.driverReserveCount+=r,n["Автобус"]=Object.assign({},e),n["Автобус"].busnumber+=" ".concat(e.status),l.driverReserveTable.push(n))):0===r?l.busReserve.push(e):(n["Автобус"]=e,l.workTable.push(n))})),this.workTable=this.workTable.concat(this.busReserve.map((function(e){return{"Автобус":e,"Первая см.":[],"Вторая см.":[],"Рабочий":[]}}))),this.workTable=this.workTable.concat(this.driverReserveTable)}},594:function(e,t,n){var content=n(595);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(13).default)("83ff91dc",content,!0,{sourceMap:!1})},595:function(e,t,n){(e.exports=n(12)(!1)).push([e.i,".theme--light.v-file-input .v-file-input__text{color:rgba(0,0,0,.87)}.theme--light.v-file-input .v-file-input__text--placeholder{color:rgba(0,0,0,.54)}.theme--dark.v-file-input .v-file-input__text{color:#fff}.theme--dark.v-file-input .v-file-input__text--placeholder{color:hsla(0,0%,100%,.7)}.v-file-input input[type=file]{opacity:0;max-width:0;width:0}.v-file-input .v-file-input__text{align-items:center;align-self:stretch;display:flex;flex-wrap:wrap;width:100%}.v-file-input .v-file-input__text.v-file-input__text--chips{flex-wrap:wrap}.v-file-input .v-file-input__text .v-chip{margin:4px}.v-file-input.v-text-field--filled:not(.v-text-field--single-line) .v-file-input__text{padding-top:22px}.v-file-input.v-text-field--outlined .v-text-field__slot{padding:6px 0}",""])},614:function(e,t,n){"use strict";n.r(t);n(7),n(6),n(46),n(49);var r=n(18),o=n(2),l=n.n(o),c=n(565),d=n.n(c),f={props:["title","loading"]},h=n(23),v=n(26),m=n.n(v),w=n(107),x=n(563),y=n(562),R=n(136),component=Object(h.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",[n("v-card-title",{staticClass:"green"},[n("v-icon",{attrs:{dark:""}},[e._v("fa-file-excel")]),e._v(" "),n("span",{staticClass:"ml-3 white--text"},[e._v(e._s(e.title))])],1),e._v(" "),n("v-card-text",{staticClass:"pt-2"},[e._t("default")],2),e._v(" "),n("v-card-actions",{staticClass:"pa-0"},[n("v-btn",{staticStyle:{"font-size":"1.4rem","border-top-left-radius":"0","border-top-right-radius":"0"},attrs:{loading:e.loading,height:"52",block:"",color:"green",dark:""},on:{click:function(t){return e.$emit("download")}}},[n("span",[e._v("Скачать")])])],1)],1)}),[],!1,null,null,null),k=component.exports;m()(component,{VBtn:w.a,VCard:x.a,VCardActions:y.a,VCardText:y.b,VCardTitle:y.c,VIcon:R.a});var C,_,O=n(566),j=n(20),D=n(21),S=n(564),$=n.n(S),L=n(578),V=function(){function e(){Object(j.a)(this,e)}var t;return Object(D.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,r,o,l,c,i,d,f,h,v,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(m=function(e,t,n,r){var o=n,l=r;e.getRow(o).getCell(l).value="Рабочие",h++;var c=d(e,t.workTable.sort((function(a,b){return a["Автобус"].busnumber-b["Автобус"].busnumber})).slice(0,Math.ceil(t.workTable.length/2)),o,l);return d(e,t.workTable.sort((function(a,b){return a["Автобус"].busnumber-b["Автобус"].busnumber})).slice(Math.ceil(t.workTable.length/2)),o,l+6),c;function d(e,t,n,r){return h=n,l=r,h++,e.getRow(h).getCell(l).value="Автобус",e.getRow(h).getCell(l+2).value="Первая",e.getRow(h).getCell(l+3).value="Вторая",e.getRow(h).getCell(l+4).value="Полный",f=++h,t.forEach((function(t,n){h=f+n,e.getRow(h).getCell(l).value=t["Автобус"].busnumber,e.getRow(h).getCell(l+2).value=t["Первая см."].map((function(e){return e.tabnumber})).join(", "),e.getRow(h).getCell(l+3).value=t["Вторая см."].map((function(e){return e.tabnumber})).join(", "),e.getRow(h).getCell(l+4).value=t["Рабочий"].map((function(e){return e.tabnumber})).join(", ");for(var r=0;r<5;r++)e.getRow(h).getCell(l+r).border={top:{style:"thin"}}})),h}},v=function(e,t,n,r){var o=n,l=0,c=r;for(var d in e.getRow(o).getCell(c).value="Автобусы",e.getRow(o+1).getCell(c).value="Резерв (".concat(t.busReserve.length,")"),l=o+=2,t.busReserve.sort((function(a,b){return a.busnumber-b.busnumber})).forEach((function(t,n){l=o+Math.floor(n/5),e.getRow(l).getCell(c+n%5).value=t.busnumber})),l+=2,t.outBuses)e.getRow(l).getCell(c).value="".concat(d," (").concat(t.outBuses[d].length,")"),o=++l,t.outBuses[d].sort((function(a,b){return a.busnumber-b.busnumber})).forEach((function(t,n){l=o+Math.floor(n/5),e.getRow(l).getCell(c+n%5).value=t.busnumber})),l+=2;for(var f in o=n,c+=5,e.getRow(o).getCell(c).value="Водители",e.getRow(o+1).getCell(c).value="Резерв (".concat(t.driverReserveCount,")"),l=o+=2,e.getRow(o).getCell(c).value="Первая см.",e.getRow(o).getCell(c+2).value="Вторая см.",e.getRow(o).getCell(c+4).value="Полный день",o=++l,t.driverReserveTable.forEach((function(t,n){l=o+n,e.getRow(l).getCell(c).value=t["Первая см."].map((function(e){return e.tabnumber})).join(", "),e.getRow(l).getCell(c+2).value=t["Вторая см."].map((function(e){return e.tabnumber})).join(", "),e.getRow(l).getCell(c+4).value=t["Рабочий"].map((function(e){return e.tabnumber})).join(", ");for(var r=0;r<6;r++)e.getRow(l).getCell(c+r).border={top:{style:"thin"}}})),o=l+=2,t.outDrivers)e.getRow(l).getCell(c).value="".concat(f," (").concat(t.outDrivers[f].length,")"),o=++l,t.outDrivers[f].sort((function(a,b){return a.tabnumber-b.tabnumber})).forEach((function(t,n){l=o+Math.floor(n/6),e.getRow(l).getCell(c+n%6).value=t.tabnumber})),l+=2;return l},n=t.buses,r=t.date,o=new $.a.Workbook,l=o.addWorksheet("Main"),c=new L.a(r,n),i=0;i<11;i++)(d=l.getColumn(i+1)).width=11,d.style={font:{size:14}};return f=1,h=m(l,c,1,1),v(l,c,h+=2,1),e.next=14,o.xlsx.writeBuffer();case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),M={components:{AppDownload:k,MenuDatePicker:O.a},data:function(){return{date:l()().format("YYYY-MM-DD"),isLoading:!1,renderer:V}},computed:{buses:function(){return this.$store.getters["buses/list"]}},methods:{get_file:(C=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.next=3,Promise.all([this.$store.dispatch("buses/readAll")]);case 3:return e.next=5,this.renderer.render({buses:this.buses,date:this.date});case 5:t=e.sent,d()(new Blob([t]),"Отчет за ".concat(l()(this.date).format("DD-MM-YY"),".xlsx")),this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})}},A=Object(h.a)(M,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-download",{attrs:{title:"Отчет",loading:e.isLoading},on:{download:e.get_file}},[n("menu-date-picker",{model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)}),[],!1,null,null,null).exports,E=(n(55),n(39),n(79),n(180)),P=function(){function e(){Object(j.a)(this,e)}var t;return Object(D.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,template,r,o,c,d,f,i,h,v,m,w,x,y,R,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(k=function(e,t,n,c){var d=n,f=c;e.getRow(d).getCell(f).value=t.busnumber;var h=[];switch(t.drivers.length){case 1:h=[4];break;case 2:h=[2,6];break;case 3:h=[1,4,7];break;case 4:h=[1,3,5,7]}t.drivers.forEach((function(t,n){if(t.tabnumber){var c=new E.a(t);!function(e,t,n,c){var d=n,f=c;e.getRow(d).getCell(f+3).value=t.shortName,e.getRow(d).getCell(f+4).value=t.tabnumber,e.getRow(d).getCell(f+5).value=t.graphicName;for(var h=l()("".concat(o,"-").concat(r),"YYYY-MM").daysInMonth(),v=t.statusesByDate({date:"".concat(o,"-").concat(r,"-01"),count:h,isShort:!0}),m=0;m<h;m++)e.getRow(d).getCell(f+8+m).value=v[m]}(e,c,d+h[n],f)}})),t.way&&(e.getRow(d).getCell(41).value="Выход: ".concat(t.way.route.title,"/").concat(t.way.title),e.getRow(d+2).getCell(41).value="1 смена: ".concat(t.way.times.durationFirstSmene||""),e.getRow(d+2).getCell(44).value="2 смена: ".concat(t.way.times.durationSecondSmene||""),e.getRow(d+3).getCell(41).value="Выезд из парка: ".concat(t.way.times.outPark||""),e.getRow(d+4).getCell(41).value="Время смены: ".concat(t.way.times.change||""),e.getRow(d+5).getCell(41).value="Окончание работы: ".concat(t.way.times.endWork||""),e.getRow(d+7).getCell(41).value="1 смена: ".concat(t.way.times.lunchFirstSmene||""),e.getRow(d+7).getCell(44).value="2 смена: ".concat(t.way.times.lunchSecondSmene||""))},n=t.buses,template=t.template,r=t.month,o="2020",c=(c=Array.from(n)).sort((function(a,b){return a.busnumber-b.busnumber})),d=Math.ceil(c.length/5),f=[],i=0;i<d;i++)for(f.push([]),h=0;h<5;h++)f[i].push(c[5*i+h]||{});return v=new $.a.Workbook,e.next=11,v.xlsx.load(template);case 11:for(m=v.getWorksheet("Page 1"),w=1;w<f.length;w++)(x=v.addWorksheet("Sheet")).model=Object.assign(m.model,{mergeCells:m.model.merges}),x.name="Page "+(1+w);for(y=function(e){(m=v.getWorksheet("Page "+(e+1))).getRow(1).getCell(44).value=e+1,f[e].forEach((function(e,t){e.busnumber&&k(m,e,10+8*t,2)}))},R=0;R<f.length;R++)y(R);return e.next=17,v.xlsx.writeBuffer();case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),B={components:{AppDownload:k,MenuDatePicker:O.a},data:function(){return{file:null,isLoading:!1,renderer:P,month:"01",items:[{text:"Январь",value:"01"},{text:"Февраль",value:"02"},{text:"Март",value:"03"},{text:"Апрель",value:"04"},{text:"Май",value:"05"},{text:"Июнь",value:"06"},{text:"Июль",value:"07"},{text:"Август",value:"08"},{text:"Сентябрь",value:"09"},{text:"Октябрь",value:"10"},{text:"Ноябрь",value:"11"},{text:"Декабрь",value:"12"}]}},computed:{buses:function(){return this.$store.getters["buses/list"]},template:function(){return this.$store.getters["templates/template"]("templates/a4.xlsx")}},methods:{get_file:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r=this,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],this.isLoading=!0,e.next=4,Promise.all([this.$store.dispatch("buses/readAll"),this.$store.dispatch("templates/download",{filename:"templates/a4.xlsx"})]);case 4:if(n=null,!t){e.next=9;break}n=this.template,e.next=12;break;case 9:return e.next=11,this.renderer.render({buses:this.buses,template:this.template,month:this.month});case 11:n=e.sent;case 12:d()(new Blob([n]),"Журнал A4 на ".concat(this.items.find((function(e){return e.value==r.month})).text,".xlsx")),this.isLoading=!1;case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),onFileChange:function(e){this.file=e},uploadFile:(_=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,(t=new FormData).append("template",this.file),e.next=5,this.$axios.post("/api/templates/a4.xlsx",t,{headers:{enctype:"multipart/form-data"}});case 5:e.sent.data,this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})}},Y=n(553),F=(n(10),n(8),n(9),n(38)),T=n(1),z=n(25),W=(n(24),n(27),n(17),n(594),n(80)),I=n(174),N=n(0),U=n(15);function H(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var J=W.a.extend({name:"v-file-input",model:{prop:"value",event:"change"},props:{chips:Boolean,clearable:{type:Boolean,default:!0},counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},placeholder:String,prependIcon:{type:String,default:"$vuetify.icons.file"},readonly:{type:Boolean,default:!1},showSize:{type:[Boolean,Number],default:!1,validator:function(e){return"boolean"==typeof e||[1e3,1024].includes(e)}},smallChips:Boolean,truncateLength:{type:[Number,String],default:22},type:{type:String,default:"file"},value:{default:function(){return[]},validator:function(e){return"object"===Object(z.a)(e)||Array.isArray(e)}}},computed:{classes:function(){return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?H(source,!0).forEach((function(t){Object(T.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):H(source).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},W.a.options.computed.classes.call(this),{"v-file-input":!0})},counterValue:function(){var e=this.isMultiple&&this.lazyValue?this.lazyValue.length:this.lazyValue instanceof File?1:0;if(!this.showSize)return this.$vuetify.lang.t(this.counterString,e);var t=this.internalArrayValue.reduce((function(e,t){return e+t.size}),0);return this.$vuetify.lang.t(this.counterSizeString,e,Object(N.v)(t,1024===this.base))},internalArrayValue:function(){return Array.isArray(this.internalValue)?this.internalValue:Object(N.E)(this.internalValue)},internalValue:{get:function(){return this.lazyValue},set:function(e){this.lazyValue=e,this.$emit("change",this.lazyValue)}},isDirty:function(){return this.internalArrayValue.length>0},isLabelActive:function(){return this.isDirty},isMultiple:function(){return this.$attrs.hasOwnProperty("multiple")},text:function(){var e=this;return this.isDirty?this.internalArrayValue.map((function(t){var n=e.truncateText(t.name);return e.showSize?"".concat(n," (").concat(Object(N.v)(t.size,1024===e.base),")"):n})):[this.placeholder]},base:function(){return"boolean"!=typeof this.showSize?this.showSize:void 0},hasChips:function(){return this.chips||this.smallChips}},watch:{readonly:{handler:function(e){!0===e&&Object(U.b)("readonly is not supported on <v-file-input>",this)},immediate:!0}},methods:{clearableCallback:function(){this.internalValue=this.isMultiple?[]:null,this.$refs.input.value=""},genChips:function(){var e=this;return this.isDirty?this.text.map((function(text,t){return e.$createElement(I.a,{props:{small:e.smallChips},on:{"click:close":function(){var n=e.internalValue;n.splice(t,1),e.internalValue=n}}},[text])})):[]},genInput:function(){var input=W.a.options.methods.genInput.call(this);return delete input.data.domProps.value,delete input.data.on.input,input.data.on.change=this.onInput,[this.genSelections(),input]},genPrependSlot:function(){var e=this;if(!this.prependIcon)return null;var t=this.genIcon("prepend",(function(){e.$refs.input.click()}));return this.genSlot("prepend","outer",[t])},genSelectionText:function(){var e=this.text.length;return e<2?this.text:this.showSize&&!this.counter?[this.counterValue]:[this.$vuetify.lang.t(this.counterString,e)]},genSelections:function(){var e=this,t=[];return this.isDirty&&this.$scopedSlots.selection?this.internalArrayValue.forEach((function(n,r){e.$scopedSlots.selection&&t.push(e.$scopedSlots.selection({text:e.text[r],file:n,index:r}))})):t.push(this.hasChips&&this.isDirty?this.genChips():this.genSelectionText()),this.$createElement("div",{staticClass:"v-file-input__text",class:{"v-file-input__text--placeholder":this.placeholder&&!this.isDirty,"v-file-input__text--chips":this.hasChips&&!this.$scopedSlots.selection},on:{click:function(){return e.$refs.input.click()}}},t)},onInput:function(e){var t=Object(F.a)(e.target.files||[]);this.internalValue=this.isMultiple?t:t[0],this.initialValue=this.internalValue},onKeyDown:function(e){this.$emit("keydown",e)},truncateText:function(e){if(e.length<Number(this.truncateLength))return e;var t=Math.floor((Number(this.truncateLength)-1)/2);return"".concat(e.slice(0,t),"…").concat(e.slice(e.length-t))}}}),X=n(552),G=n(554),K=n(532),Q=Object(h.a)(B,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-download",{attrs:{title:"A4",loading:e.isLoading},on:{download:e.get_file}},[n("v-select",{attrs:{items:e.items,label:"Месяц"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}}),e._v(" "),n("v-file-input",{attrs:{label:"Шаблон"},on:{change:e.onFileChange}}),e._v(" "),n("v-layout",[n("v-row",[n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:e.uploadFile}},[e._v("Загрузить")])],1),e._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:function(t){return e.get_file(!0)}}},[e._v("Скачать")])],1)],1)],1)],1)}),[],!1,null,null,null),Z=Q.exports;m()(Q,{VBtn:w.a,VCol:Y.a,VFileInput:J,VLayout:X.a,VRow:G.a,VSelect:K.a});var ee=function(){function e(){Object(j.a)(this,e)}var t;return Object(D.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,template,r,o,c,d,f,h,i,v,m,w,x,y,R,k,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=9,d=20;function f(e,t,n,c){var d=n,f=c;if(t.busnumber){var h=[];switch(t.drivers.length){case 1:h=[4];break;case 2:h=[2,6];break;case 3:h=[1,4,7];break;case 4:h=[1,3,5,7]}t.drivers.forEach((function(t,n){for(var c=new E.a(t),v=l()("".concat(o,"-").concat(r),"YYYY-MM").daysInMonth(),m=c.statusesByDate({date:"".concat(o,"-").concat(r,"-13"),count:v-12,isShort:!0}),w=0;w<v-12;w++)e.getRow(d+h[n]).getCell(f+w).value=m[w]})),t.way&&(e.getRow(d).getCell(f+19).value="Выход: ".concat(t.way.route.title,"/").concat(t.way.title),e.getRow(d+2).getCell(f+19).value="1 смена: ".concat(t.way.times.durationFirstSmene||""),e.getRow(d+2).getCell(f+22).value="2 смена: ".concat(t.way.times.durationSecondSmene||""),e.getRow(d+3).getCell(f+19).value="Выезд из парка: ".concat(t.way.times.outPark||""),e.getRow(d+4).getCell(f+19).value="Время смены: ".concat(t.way.times.change||""),e.getRow(d+5).getCell(f+19).value="Окончание работы: ".concat(t.way.times.endWork||""),e.getRow(d+7).getCell(f+19).value="1 смена: ".concat(t.way.times.lunchFirstSmene||""),e.getRow(d+7).getCell(f+22).value="2 смена: ".concat(t.way.times.lunchSecondSmene||""))}}e.getRow(1).getCell(44).value=n,t.forEach((function(t){f(e,t,c,d),c+=8}))},k=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=9,c=2;function d(e,t,n,l){var c=n,d=l;if(t.busnumber){e.getRow(c).getCell(d).value=t.busnumber;var f=[];switch(t.drivers.length){case 1:f=[4];break;case 2:f=[2,6];break;case 3:f=[1,4,7];break;case 4:f=[1,3,5,7]}t.drivers.forEach((function(t,n){var l=new E.a(t);!function(e,t,n,l){var c=n,d=l;e.getRow(c).getCell(d+1).value=t.shortName,e.getRow(c).getCell(d+2).value=t.tabnumber;for(var f=t.statusesByDate({date:"".concat(o,"-").concat(r,"-01"),count:12,isShort:!0}),h=0;h<12;h++)e.getRow(c).getCell(d+4+h).value=f[h]}(e,l,c+f[n],d)}))}}e.getRow(1).getCell(2).value=n,t.forEach((function(t){d(e,t,l,c),l+=8}))},n=t.buses,template=t.template,r=t.month,o="2020",c=(c=Array.from(n)).sort((function(a,b){return a.busnumber-b.busnumber})),d=new $.a.Workbook,e.next=9,d.xlsx.load(template);case 9:for((f=Math.ceil(c.length/4))%2==0&&f++,h=[],i=0;i<f;i++)for(h.push([]),v=0;v<4;v++)h[i].push(c[4*i+v]||{});for(h.unshift([{},{},{},{}]),m=h.length,w=d.getWorksheet("Page 1"),x=1;x<m;x++)(y=d.addWorksheet("Sheet")).model=Object.assign(w.model,{mergeCells:w.model.merges}),y.name="Page "+(1+x);for(R=0;R<m/2;R++)w=d.getWorksheet("Page "+(2*R+1)),k(w,h[R+1],R+1),C(w,h[m-(R+1)],m-(R+1)),w=d.getWorksheet("Page "+(2*R+2)),k(w,h[(m-R)%m],(m-R)%m),C(w,h[R],R);return e.next=20,d.xlsx.writeBuffer();case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),te={components:{AppDownload:k,MenuDatePicker:O.a},data:function(){return{file:null,isLoading:!1,renderer:ee,month:"01",items:[{text:"Январь",value:"01"},{text:"Февраль",value:"02"},{text:"Март",value:"03"},{text:"Апрель",value:"04"},{text:"Май",value:"05"},{text:"Июнь",value:"06"},{text:"Июль",value:"07"},{text:"Август",value:"08"},{text:"Сентябрь",value:"09"},{text:"Октябрь",value:"10"},{text:"Ноябрь",value:"11"},{text:"Декабрь",value:"12"}]}},computed:{buses:function(){return this.$store.getters["buses/list"]},template:function(){return this.$store.getters["templates/template"]("templates/a3.xlsx")}},methods:{get_file:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r=this,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],this.isLoading=!0,e.next=4,Promise.all([this.$store.dispatch("buses/readAll"),this.$store.dispatch("templates/download",{filename:"templates/a3.xlsx"})]);case 4:if(n=null,!t){e.next=9;break}n=this.template,e.next=12;break;case 9:return e.next=11,this.renderer.render({buses:this.buses,template:this.template,month:this.month});case 11:n=e.sent;case 12:d()(new Blob([n]),"Журнал A3 на ".concat(this.items.find((function(e){return e.value==r.month})).text,".xlsx")),this.isLoading=!1;case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),onFileChange:function(e){this.file=e},uploadFile:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,(t=new FormData).append("template",this.file),e.next=5,this.$axios.post("/api/templates/a3.xlsx",t,{headers:{enctype:"multipart/form-data"}});case 5:n=e.sent,n.data,this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},ne=Object(h.a)(te,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-download",{attrs:{title:"A3",loading:e.isLoading},on:{download:e.get_file}},[n("v-select",{attrs:{items:e.items,label:"Месяц"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}}),e._v(" "),n("v-file-input",{attrs:{label:"Шаблон"},on:{change:e.onFileChange}}),e._v(" "),n("v-layout",[n("v-row",[n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:e.uploadFile}},[e._v("Загрузить")])],1),e._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:function(t){return e.get_file(!0)}}},[e._v("Скачать")])],1)],1)],1)],1)}),[],!1,null,null,null),re=ne.exports;m()(ne,{VBtn:w.a,VCol:Y.a,VFileInput:J,VLayout:X.a,VRow:G.a,VSelect:K.a});var ae=function(){function e(){Object(j.a)(this,e)}var t;return Object(D.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,template,r,o,l,c,d,f,h,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.drivers,template=t.template,r=t.month,o=new $.a.Workbook,e.next=4,o.xlsx.load(template);case 4:return l=Array.from(n).sort((function(a,b){return a.tabnumber-b.tabnumber})),c=o.getWorksheet("main"),d=["январе","феврале","марте","апреле","мае","июне","июле","фвгусте","сентябре","октябре","ноябре","декабре"],c.getRow(1).getCell(1).value='Администрация Филиала "Юго-Западный", в лице директора  Р.А. Езохова, предлагает нижеперечисленным водителям 13-ой автоколонны выполнять сверхурочную работу за пределами установленной продолжительности рабочего времени (баланса), а так же работу в выходные, праздничные дни в '.concat(d[+r-1]," 2019  года."),f=3,h=0,v=0,l.forEach((function(e){h=2+4*v,c.getRow(f).getCell(h).value=e.tabnumber,h=3+4*v,c.getRow(f).getCell(h).value=e.shortName,51==++f&&(f=3,v++)})),e.next=14,o.xlsx.writeBuffer();case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),oe={components:{AppDownload:k,MenuDatePicker:O.a},data:function(){return{file:null,isLoading:!1,renderer:ae,month:"01",items:[{text:"Январь",value:"01"},{text:"Февраль",value:"02"},{text:"Март",value:"03"},{text:"Апрель",value:"04"},{text:"Май",value:"05"},{text:"Июнь",value:"06"},{text:"Июль",value:"07"},{text:"Август",value:"08"},{text:"Сентябрь",value:"09"},{text:"Октябрь",value:"10"},{text:"Ноябрь",value:"11"},{text:"Декабрь",value:"12"}]}},computed:{drivers:function(){return this.$store.getters["drivers/list"]},template:function(){return this.$store.getters["templates/template"]("templates/agreement.xlsx")}},methods:{get_file:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r=this,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],this.isLoading=!0,e.next=4,Promise.all([this.$store.dispatch("drivers/readAll"),this.$store.dispatch("templates/download",{filename:"templates/agreement.xlsx"})]);case 4:if(n=null,!t){e.next=9;break}n=this.template,e.next=12;break;case 9:return e.next=11,this.renderer.render({drivers:this.drivers,template:this.template,month:this.month});case 11:n=e.sent;case 12:d()(new Blob([n]),"Согласие за ".concat(this.items.find((function(e){return e.value==r.month})).text,".xlsx")),this.isLoading=!1;case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),onFileChange:function(e){this.file=e},uploadFile:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,(t=new FormData).append("template",this.file),e.next=5,this.$axios.post("/api/templates/agreement.xlsx",t,{headers:{enctype:"multipart/form-data"}});case 5:n=e.sent,n.data,this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},ie=Object(h.a)(oe,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-download",{attrs:{title:"Согласие",loading:e.isLoading},on:{download:e.get_file}},[n("v-select",{attrs:{items:e.items,label:"Месяц"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}}),e._v(" "),n("v-file-input",{attrs:{label:"Шаблон"},on:{change:e.onFileChange}}),e._v(" "),n("v-layout",[n("v-row",[n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:e.uploadFile}},[e._v("Загрузить")])],1),e._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:function(t){return e.get_file(!0)}}},[e._v("Скачать")])],1)],1)],1)],1)}),[],!1,null,null,null),se=ie.exports;m()(ie,{VBtn:w.a,VCol:Y.a,VFileInput:J,VLayout:X.a,VRow:G.a,VSelect:K.a});var le=n(165),ue=n(183),ce=function(){function e(){Object(j.a)(this,e)}var t;return Object(D.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,r,o,l,c,d,f,i,h,v,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.outfitItems,r=t.routes,o=t.drivers,l=t.buses,c=t.date,d=new $.a.Workbook,f=d.addWorksheet("Main"),i=0;i<11;i++)(h=f.getColumn(i+1)).width=11,h.style={font:{size:14}};return v=Array.from(r).sort((function(a,b){return a.title!=b.title?a.title<b.title?-1:1:0})),f.addRow(["Маршрут","Выход","Автобус","Первая","Вторая","Полный"]),m=2,v.forEach((function(e){if(e.hasActiveWays(c)){for(var t=0;t<6;t++)f.getRow(m).getCell(t+1).border={top:{style:"thin"}};f.getRow(m++).getCell(1).value=e.title,Array.from(e.ways).sort((function(a,b){return a.title.slice(1)!=b.title.slice(1)?a.title.slice(1)<b.title.slice(1)?-1:1:0})).forEach((function(e){if(new ue.a(e).isActive(c)){var t=n.find((function(t){return t.wayId==e._id}));if(t){for(var r=0;r<6;r++)f.getRow(m).getCell(r+1).border={top:{style:"thin"}};f.getRow(m).getCell(2).value=e.title;var d=l.find((function(e){return e._id==t.bus}));d&&(f.getRow(m).getCell(3).value=d.busnumber);var h=o.find((function(e){return e._id==t.firstSmene}));h&&(f.getRow(m).getCell(4).value=h.tabnumber),(h=o.find((function(e){return e._id==t.secondSmene})))&&(f.getRow(m).getCell(5).value=h.tabnumber),(h=o.find((function(e){return e._id==t.allDay})))&&(f.getRow(m).getCell(6).value=h.tabnumber),m++}}}))}})),e.next=10,d.xlsx.writeBuffer();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}();function de(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var fe={components:{AppDownload:k,MenuDatePicker:O.a},data:function(){return{date:l()().format("YYYY-MM-DD"),isLoading:!1,renderer:ce}},computed:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?de(source,!0).forEach((function(t){Object(T.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):de(source).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},Object(le.b)({buses:"buses/list",drivers:"drivers/list",routes:"routes/list",outfitItems:"outfit/items"})),methods:{get_file:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.next=3,Promise.all([this.$store.dispatch("buses/readAll"),this.$store.dispatch("drivers/readAll"),this.$store.dispatch("routes/readAll"),this.$store.dispatch("outfit/readByDate",{date:this.date})]);case 3:return e.next=5,this.renderer.render({outfitItems:this.outfitItems,routes:this.routes,drivers:this.drivers,buses:this.buses,date:this.date});case 5:t=e.sent,d()(new Blob([t]),"Наряд на ".concat(l()(this.date).format("DD-MM-YY"),".xlsx")),this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},he=Object(h.a)(fe,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-download",{attrs:{title:"Наряд",loading:e.isLoading},on:{download:e.get_file}},[n("menu-date-picker",{model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)}),[],!1,null,null,null).exports,pe=function(){function e(){Object(j.a)(this,e)}var t;return Object(D.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,r,o,l,c,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.drivers,t.template,t.month,r=new $.a.Workbook,o=Array.from(n).sort((function(a,b){return a.tabnumber-b.tabnumber})),l=r.addWorksheet("main"),(c=l.getColumn(1)).width=16,c.style={font:{size:14}},(c=l.getColumn(2)).width=44,c.style={font:{size:14}},(c=l.getColumn(3)).width=33,c.style={font:{size:14}},l.addRow(["Таб. номер","Ф.И.О.","Номера тел."]),d=1,o.forEach((function(e){for(var i=0;i<3;i++)l.getRow(d).getCell(i+1).border={bottom:{style:"thin"}};var t=e.phones.map((function(e){return e.value}));if(l.addRow([e.tabnumber,e.name,t[0]||""]),t.length>1)for(var n=1;n<t.length;n++)l.addRow(["","",t[n]]),d++;d++})),e.next=18,r.xlsx.writeBuffer();case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),ve={components:{AppDownload:k},data:function(){return{isLoading:!1,renderer:pe}},computed:{drivers:function(){return this.$store.getters["drivers/list"]}},methods:{get_file:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.next=3,Promise.all([this.$store.dispatch("drivers/readAll")]);case 3:return e.next=5,this.renderer.render({drivers:this.drivers});case 5:t=e.sent,d()(new Blob([t]),"Номера телефонов ".concat(l()(this.date).format("DD-MM-YY"),".xlsx")),this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},me=Object(h.a)(ve,(function(){var e=this.$createElement;return(this._self._c||e)("app-download",{attrs:{title:"Номера телефонов",loading:this.isLoading},on:{download:this.get_file}})}),[],!1,null,null,null).exports,ge=function(){function e(){Object(j.a)(this,e)}var t;return Object(D.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,r,o,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.buses,t.template,t.month,r=new $.a.Workbook,o=Array.from(n).sort((function(a,b){return a.busnumber-b.busnumber})),l=r.addWorksheet("main"),(c=l.getColumn(1)).width=22,c.style={font:{size:14}},(c=l.getColumn(2)).width=22,c.style={font:{size:14}},(c=l.getColumn(3)).width=17,c.style={font:{size:14}},(c=l.getColumn(4)).width=17,c.style={font:{size:14}},(c=l.getColumn(5)).width=34,c.style={font:{size:14}},l.addRow(["Борт. номер/Вмест.","Марка","Цвет","Год","Примечание"]),o.forEach((function(e,t){l.addRow(["".concat(e.busnumber," ").concat(e.capacity),e.mark,e.color,e.year,""]);for(var i=0;i<4;i++)l.getRow(t+2).getCell(i+1).border={top:{style:"thin"}};l.getRow(t+2).getCell(5).border={left:{style:"thin"},top:{style:"thin"}}})),e.next=23,r.xlsx.writeBuffer();case 23:return e.abrupt("return",e.sent);case 24:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),be={components:{AppDownload:k},data:function(){return{isLoading:!1,renderer:ge}},computed:{buses:function(){return this.$store.getters["buses/list"]}},methods:{get_file:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.next=3,Promise.all([this.$store.dispatch("buses/readAll")]);case 3:return e.next=5,this.renderer.render({buses:this.buses});case 5:t=e.sent,d()(new Blob([t]),"Автобусы ".concat(l()(this.date).format("DD-MM-YY"),".xlsx")),this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},we=Object(h.a)(be,(function(){var e=this.$createElement;return(this._self._c||e)("app-download",{attrs:{title:"Автобусы",loading:this.isLoading},on:{download:this.get_file}})}),[],!1,null,null,null).exports,xe=function(){function e(){Object(j.a)(this,e)}var t;return Object(D.a)(e,null,[{key:"render",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,template,r,o,c,d,f,i,h,v,m,w,x,y,R,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(k=function(e,t,n,c){var d=n,f=c;e.getRow(d).getCell(f+2).value=t.busnumber;var h=[];switch(t.drivers.length){case 1:h=[3];break;case 2:h=[1,5];break;case 3:h=[0,3,6];break;case 4:h=[0,2,4,6]}t.drivers.forEach((function(t,n){if(t.tabnumber){var c=new E.a(t);!function(e,t,n,c){var d=n,f=c+1;e.getRow(d).getCell(f+4).value=t.shortName,e.getRow(d).getCell(f+5).value=t.tabnumber;var h=t.graphicName;e.getRow(d+1).getCell(f+4).value="(ЛВ".concat(h,") ").concat(h[0]," раб. - ").concat(h[1]," вых.");for(var v=l()("".concat(o,"-").concat(r),"YYYY-MM").daysInMonth(),m=t.statusesByDate({date:"".concat(o,"-").concat(r,"-01"),count:v,isShort:!0}),w=0;w<v;w++)e.getRow(d).getCell(f+8+w).value=m[w]}(e,c,d+h[n],f)}})),t.way&&(e.getRow(d).getCell(1).value=t.way.route.title,e.getRow(d).getCell(2).value=t.way.title,e.getRow(d).getCell(41).value="Выход: ".concat(t.way.route.title,"/").concat(t.way.title),e.getRow(d+2).getCell(41).value="1 смена: ".concat(t.way.times.durationFirstSmene||""),e.getRow(d+2).getCell(44).value="2 смена: ".concat(t.way.times.durationSecondSmene||""),e.getRow(d+3).getCell(41).value="Выезд из парка: ".concat(t.way.times.outPark||""),e.getRow(d+4).getCell(41).value="Время смены: ".concat(t.way.times.change||""),e.getRow(d+5).getCell(41).value="Окончание работы: ".concat(t.way.times.endWork||""),e.getRow(d+7).getCell(41).value="1 смена: ".concat(t.way.times.lunchFirstSmene||""),e.getRow(d+7).getCell(44).value="2 смена: ".concat(t.way.times.lunchSecondSmene||""))},n=t.buses,template=t.template,r=t.month,o="2020",c=(c=Array.from(n)).sort((function(a,b){return a.busnumber-b.busnumber})),d=Math.ceil(c.length/5),f=[],i=0;i<d;i++)for(f.push([]),h=0;h<5;h++)f[i].push(c[5*i+h]||{});return v=new $.a.Workbook,e.next=11,v.xlsx.load(template);case 11:for(m=v.getWorksheet("Page 1"),w=1;w<f.length;w++)(x=v.addWorksheet("Sheet")).model=Object.assign(m.model,{mergeCells:m.model.merges}),x.name="Page "+(1+w);for(y=function(e){(m=v.getWorksheet("Page "+(e+1))).getRow(1).getCell(44).value=e+1,f[e].forEach((function(e,t){e.busnumber&&k(m,e,10+8*t,1)}))},R=0;R<f.length;R++)y(R);return e.next=17,v.xlsx.writeBuffer();case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),ye={components:{AppDownload:k,MenuDatePicker:O.a},data:function(){return{file:null,isLoading:!1,renderer:xe,month:"01",items:[{text:"Январь",value:"01"},{text:"Февраль",value:"02"},{text:"Март",value:"03"},{text:"Апрель",value:"04"},{text:"Май",value:"05"},{text:"Июнь",value:"06"},{text:"Июль",value:"07"},{text:"Август",value:"08"},{text:"Сентябрь",value:"09"},{text:"Октябрь",value:"10"},{text:"Ноябрь",value:"11"},{text:"Декабрь",value:"12"}]}},computed:{buses:function(){return this.$store.getters["buses/list"]},template:function(){return this.$store.getters["templates/template"]("templates/new_a4.xlsx")}},methods:{get_file:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r=this,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],this.isLoading=!0,e.next=4,Promise.all([this.$store.dispatch("buses/readAll"),this.$store.dispatch("templates/download",{filename:"templates/new_a4.xlsx"})]);case 4:if(n=null,!t){e.next=9;break}n=this.template,e.next=12;break;case 9:return e.next=11,this.renderer.render({buses:this.buses,template:this.template,month:this.month});case 11:n=e.sent;case 12:d()(new Blob([n]),"Журнал A4 на ".concat(this.items.find((function(e){return e.value==r.month})).text,".xlsx")),this.isLoading=!1;case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),onFileChange:function(e){this.file=e},uploadFile:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,(t=new FormData).append("template",this.file),e.next=5,this.$axios.post("/api/templates/new_a4.xlsx",t,{headers:{enctype:"multipart/form-data"}});case 5:n=e.sent,n.data,this.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},Re=Object(h.a)(ye,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-download",{attrs:{title:"Новый A4",loading:e.isLoading},on:{download:e.get_file}},[n("v-select",{attrs:{items:e.items,label:"Месяц"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}}),e._v(" "),n("v-file-input",{attrs:{label:"Шаблон"},on:{change:e.onFileChange}}),e._v(" "),n("v-layout",[n("v-row",[n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:e.uploadFile}},[e._v("Загрузить")])],1),e._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{rounded:"",color:"green",dark:""},on:{click:function(t){return e.get_file(!0)}}},[e._v("Скачать")])],1)],1)],1)],1)}),[],!1,null,null,null),ke=Re.exports;m()(Re,{VBtn:w.a,VCol:Y.a,VFileInput:J,VLayout:X.a,VRow:G.a,VSelect:K.a});var Ce={transition:"fade",components:{DownloadReport:A,DownloadA4:Z,DownloadA3:re,DownloadAgreement:se,DownloadOutfit:he,DownloadDriverPhones:me,DownloadBuses:we,DownloadNewA4:ke}},_e=Object(h.a)(Ce,(function(){var e=this.$createElement,t=this._self._c||e;return t("v-layout",[t("v-row",[t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-new-a4")],1),this._v(" "),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-a4")],1),this._v(" "),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-a3")],1),this._v(" "),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-agreement")],1),this._v(" "),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-report")],1),this._v(" "),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-outfit")],1),this._v(" "),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-driver-phones")],1),this._v(" "),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("download-buses")],1)],1)],1)}),[],!1,null,null,null);t.default=_e.exports;m()(_e,{VCol:Y.a,VLayout:X.a,VRow:G.a})},80:function(e,t,n){"use strict";var r=n(77);t.a=r.a}}]);